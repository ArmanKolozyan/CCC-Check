name: ccc-check
version: 1.0.0
synopsis: Language-agnostic detection of computation-constraint inconsistencies in ZKP programs
license: MIT
category: Cryptography, Security, Static Analysis

library:
  source-dirs:
    - src
    - src/Value_Inferencer
  exposed-modules:
    - ValueAnalysis.Analysis
    - ValueDomain.Domain
    - Syntax.AST
    - Syntax.Compiler
    - ValueAnalysis.UserRules
    - ValueAnalysis.VariableState
    - ValueAnalysis.ValueDomain
    - ValueAnalysis.Printer
    - BugDetection.BugDetection
  other-modules:
    - Paths_ccc_check
  dependencies:
    - base > 4.7 && < 5
    - rio
    - maf2-syntax
    - maf2-domains
    - maf2-analysis
    - mtl
    - singletons
    - containers
    - deepseq

executables:
  ccc-check:
    source-dirs: app
    main: Main.hs
    dependencies:
      - ccc-check
      - rio
      - base > 4.7 && < 5
      - maf2-analysis
      - maf2-domains
      - maf2-syntax
      - containers
    other-modules:
      - Paths_ccc_check

tests:
  all-tests:
    main: TestRunner.hs
    source-dirs: test
    dependencies:
      - base > 4.7 && < 5
      - rio
      - maf2-analysis
      - maf2-domains
      - maf2-syntax
      - ccc-check
      - containers
      - hspec
    other-modules:
      - Syntax.ExpressionsParseTest
      - Syntax.IteParseTest
      - Value_Inferencer.ValueAnalysis.Num2BitsTest
      - Value_Inferencer.ValueAnalysis.NonZeroTest
      - Value_Inferencer.ValueAnalysis.NonZeroTemplateTest
      - Value_Inferencer.ValueAnalysis.LessThanTest
      - Value_Inferencer.BugDetection.SortTest
      - Value_Inferencer.BugDetection.Veridise.Edwards2MontgomeryWrongTest
      - Value_Inferencer.BugDetection.Veridise.Edwards2MontgomeryFixedTest
      - Value_Inferencer.BugDetection.Veridise.Montgomery2EdwardsWrongTest
      - Value_Inferencer.BugDetection.Veridise.Montgomery2EdwardsFixedTest
      - Value_Inferencer.BugDetection.Veridise.MontgomeryAddWrongTest
      - Value_Inferencer.BugDetection.Veridise.MontgomeryAddFixedTest
      - Value_Inferencer.BugDetection.Veridise.MontgomeryDoubleWrongTest
      - Value_Inferencer.BugDetection.Veridise.MontgomeryDoubleFixedTest
      - Value_Inferencer.BugDetection.TrailOfBits.ToBinaryTest
      - Value_Inferencer.BugDetection.TrailOfBits.EnforceAuthTest
      - Value_Inferencer.BugDetection.Arrays.ArrayTagTest
      - Value_Inferencer.BugDetection.Arrays.ArraySelectOutOfBoundsTest
      - Value_Inferencer.BugDetection.Arrays.ArrayStoreOutOfBoundsTest
      - Value_Inferencer.BugDetection.TaggedCircomlib.DecoderTestRaw
      - Value_Inferencer.BugDetection.TaggedCircomlib.DecoderTestBinary
      - Value_Inferencer.BugDetection.TaggedCircomlib.DecoderTestNoOutputTag
      - Value_Inferencer.BugDetection.TaggedCircomlib.ModSumTest

      - Value_Inferencer.BugDetection.TaggedCircomlib.NotTest
      - Value_Inferencer.BugDetection.TaggedCircomlib.XorTest
      - Value_Inferencer.BugDetection.TaggedCircomlib.AndTest
      - Value_Inferencer.BugDetection.TaggedCircomlib.OrTest
      - Value_Inferencer.BugDetection.TaggedCircomlib.NandTest
      - Value_Inferencer.BugDetection.TaggedCircomlib.NorTest
      - Value_Inferencer.BugDetection.TaggedCircomlib.IsZeroTest
      - Value_Inferencer.BugDetection.TaggedCircomlib.IsZeroForcedTest
      - Value_Inferencer.BugDetection.TaggedCircomlib.IsEqualTest
      - Value_Inferencer.BugDetection.TaggedCircomlib.IsEqualForcedTest
      - Value_Inferencer.BugDetection.TaggedCircomlib.Num2BitsTest
      - Value_Inferencer.BugDetection.TaggedCircomlib.Bits2NumTest
      - Value_Inferencer.BugDetection.TaggedCircomlib.MultiMux1Test
      - Value_Inferencer.BugDetection.TaggedCircomlib.Mux1Test
      - Value_Inferencer.BugDetection.TaggedCircomlib.LessThanTest
      - Value_Inferencer.BugDetection.TaggedCircomlib.GreaterThanTest
      - Value_Inferencer.BugDetection.TaggedCircomlib.GreaterEqThanTest
      - Value_Inferencer.BugDetection.TaggedCircomlib.LessEqThanTest
      - Value_Inferencer.BugDetection.TaggedCircomlib.BigLessThanTest
      - Value_Inferencer.BugDetection.TaggedCircomlib.BinSubTest
      - Value_Inferencer.BugDetection.TaggedCircomlib.BinSubTestDeep
      - Value_Inferencer.BugDetection.TaggedCircomlib.BinSumTest
      - Value_Inferencer.BugDetection.TaggedCircomlib.SumTestDeep

benchmarks:
      
  taggedcircomlib-bench:
    main: TaggedCircomlibBench.hs
    source-dirs: 
      - evaluation/benchmarking
      - test
    other-modules:
      - Value_Inferencer.BugDetection.TaggedCircomlib.NotTest
      - Value_Inferencer.BugDetection.TaggedCircomlib.XorTest
      - Value_Inferencer.BugDetection.TaggedCircomlib.AndTest
      - Value_Inferencer.BugDetection.TaggedCircomlib.OrTest
      - Value_Inferencer.BugDetection.TaggedCircomlib.NandTest
      - Value_Inferencer.BugDetection.TaggedCircomlib.NorTest
      - Value_Inferencer.BugDetection.TaggedCircomlib.IsZeroTest
      - Value_Inferencer.BugDetection.TaggedCircomlib.DecoderTestRaw
      - Value_Inferencer.BugDetection.TaggedCircomlib.IsEqualTest
      - Value_Inferencer.BugDetection.TaggedCircomlib.Num2BitsTest
      - Value_Inferencer.BugDetection.TaggedCircomlib.Bits2NumTest
      - Value_Inferencer.BugDetection.TaggedCircomlib.MultiMux1Test
      - Value_Inferencer.BugDetection.TaggedCircomlib.Mux1Test
      - Value_Inferencer.BugDetection.TaggedCircomlib.LessThanTest
      - Value_Inferencer.BugDetection.TaggedCircomlib.GreaterThanTest
      - Value_Inferencer.BugDetection.TaggedCircomlib.GreaterEqThanTest
      - Value_Inferencer.BugDetection.TaggedCircomlib.LessEqThanTest
      - Value_Inferencer.BugDetection.TaggedCircomlib.BigLessThanTest
      - Value_Inferencer.BugDetection.TaggedCircomlib.BinSubTest
      - Value_Inferencer.BugDetection.TaggedCircomlib.BinSumTest
    ghc-options:
      - -threaded
      - -rtsopts
      - -with-rtsopts=-N
      - -O2
    dependencies:
      - base
      - ccc-check
      - criterion
      - deepseq
      - containers
      - rio
      - maf2-analysis
      - maf2-domains
      - maf2-syntax
      - hspec
